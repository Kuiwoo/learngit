<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie9"><![endif]-->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <meta name="format-detection" content="telephone=no">
        <meta charset="UTF-8">

        <meta name="description" content="Violate Responsive Admin Template">
        <meta name="keywords" content="Super Admin, Admin, Template, Bootstrap">

        <title>write</title>
            
        <!-- CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/animate.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/form.css" rel="stylesheet">
        <link href="css/calendar.css" rel="stylesheet">
        <link href="css/media-player.css" rel="stylesheet">
        <link href="css/style-write.css" rel="stylesheet">
        <link href="css/icons.css" rel="stylesheet">
        <link href="css/generics.css" rel="stylesheet"> 
        <style type="text/css">
        	.addSome{
        		color: #33BE40!important;
        	}
        </style>
    </head>
    <body id="skin-blur-violate">

        
     
        
        <section id="main" class="p-relative" role="main">
            
       
            <section id="content" class="container">
            
           
   
              <a href="blog.html">  <h4 class="page-title">返回</h4></a>
                                
                <div class="block-area">
                    <div class="row m-container">
                        

                        <div class="col-xs-1 col-md-1 col-sm-0"></div>
                        <div class="col-xs-10 col-md-10 col-sm-12">
                            


                            <!-- Quick Posting -->
                            <div class="tile">
                                <h2 class="tile-title">write</h2>
                                <!--div class="tile-config dropdown">
                                    <a data-toggle="dropdown" href="" class="tooltips tile-menu" title="" data-original-title="Options"></a>
                                    <ul class="dropdown-menu pull-right text-right">
                                        <li><a href="">Edit</a></li>
                                        <li><a href="">Delete</a></li>
                                    </ul>
                                </div-->
                                
                                <form role="form" class="p-15">
                                    <div class="form-group m-b-15">
                                        <label>标题</label>
                                        <input type="text" class="form-control input-sm">
                                    </div>
                                    
                                    <div class="form-group m-b-15 col-xs-4">
                                        <label>分类</label>
                                        <select class="select" id="type1">
                                            <option value='norm'>普通（无）</option>
                                           
                                            <option class="addSome addType1" id="addType1">新增分类</option>
                                        </select>
                                    </div>
                                    <div class="form-group m-b-15 col-xs-4">
                                        <label>次级分类</label>
                                        <select class="select" id="type2">
                                           <option value='norm'>普通（无）</option>
                                           
                                            <option class="addSome addType1" id="addType2">新增分类</option>
                                        </select>
                                    </div>
                                    <div class="form-group m-b-15 col-xs-4">
                                        <label>小分类</label>
                                        <select class="select" id="type3">
                                            <option value='norm'>普通（无）</option>
                                          
                                            <option class="addSome"  id="addType3">新增分类</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group m-b-15" style="margin-top: 70px;">
                                        <label></label>
                                        <div class="wysiwye-editor"></div>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-sm">Submit</button>
                                    <button type="submit" class="btn btn-sm">Clear</button>
                                    
                                </form>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
            </section>
        </section>
        
        <!-- Javascript Libraries -->
        <!-- jQuery -->
        <script src="js/jquery.min.js"></script> <!-- jQuery Library -->
        <script src="js/jquery-ui.min.js"></script> <!-- jQuery UI -->

        <!-- Bootstrap -->
        <script src="js/bootstrap.min.js"></script>
        
      
        <!-- Text Editor -->
        <script src="js/editor.min.js"></script> <!-- WYSIWYG Editor -->
        

        <!-- UX -->
        <script src="js/scroll.min.js"></script> <!-- Custom Scrollbar -->
        
        <!-- Other -->
        <script src="js/calendar.min.js"></script> <!-- Calendar -->
        <script src="js/feeds.min.js"></script> <!-- News Feeds -->
        
        
        <!-- All JS functions -->
        <script src="js/functions.js"></script>
        
        <script type="text/javascript">
        typeList={};
        typeData=null;
        	$(function(){
        		getTypeList();
        	});
        
            $(document).ready(function() {
                
                //Calendar
                (function(){
                    var date = new Date();
                    var d = date.getDate();
                    var m = date.getMonth();
                    var y = date.getFullYear();
                    
                    
                    $('body').on('click', '#addEvent', function(){
                         var eventForm =  $(this).closest('.modal').find('.form-validation');
                         eventForm.validationEngine('validate');
                         
                         if (!(eventForm).find('.formErrorContent')[0]) {
                              
                              //Event Name
                              var eventName = $('#eventName').val();
    
                              //Render Event
                              $('#calendar').fullCalendar('renderEvent',{
                                   title: eventName,
                                   start: $('#getStart').val(),
                                   end:  $('#getEnd').val(),
                                   allDay: true,
                              },true ); //Stick the event
                              
                              $('#addNew-event form')[0].reset()
                              $('#addNew-event').modal('hide');
                         } 
                    });
                    
                    //Calendar views
                    $('body').on('click', '.calendar-actions > li > a', function(e){
                       // e.preventDefault();
                        var dataView = $(this).attr('data-view');
                        $('#calendar').fullCalendar('changeView', dataView);
                        
                        //Custom scrollbar
                        var overflowRegular, overflowInvisible = false;
                        overflowRegular = $('.overflow').niceScroll();     
                    });      
                })();
            });    
            
            $(function(){
            	$('.note-editable').css('height','400px');
            	
            });
            
            function getTypeList(){
            	$.ajax({
					url: 'http://localhost/index.php?app=user&act=typeList',
					type: 'GET',
					success: function(result) {
						if(result && result.retval!=false){
							var data=result.retval;
							typeData=data;
							for(var n in data){
								for(var i in data[n]){
									console.log(data[n][i].title);
									$('#addType'+(parseInt(n)+1)).before('<option value="'+data[n][i].id+'" class="select-index-'+(parseInt(n)+1)+ '  selectone'+data[n][i].id+'">'+data[n][i].title+'</option>');
									typeList[data[n][i].title]=data[n][i].id;
								}
							}
						if($('.select')[0]) {
						    $('.select').selectpicker();
						}
						}else{
						alert('获取数据出错');
        			return false;
						}
						}
					});
            	
            }
            $('.select').change(function(){
            	var selected=$(this).find("option:selected").text();
            	var selectId=$(this).attr('id');
            	var id=selectId.replace('type','');
            	console.log($(this).find("option:selected").val());
            	if(id<3){
            		var parentId=typeList[selected];
            		var chaildList=typeData[parentId];
            		$('.select-index-'+(parseInt(id)+1)).parent('li').hide();
            		for(var i in typeData[id]){
            			console.log(typeData[id][i]);
            			if(typeData[id][i].parentId==parentId){
            				$('.selectone'+typeData[id][i].id).parent('li').show();
            			}
            		}
            	}
            	$('#type'+(parseInt(id)+1)).selectpicker('val','norm');
            });
       </script>
       
         <!-- Form Related -->
       <script src="js/select.min.js"></script> <!--  Custom Select -->
        <script src="js/icheck.js"></script> <!-- Custom Checkbox + Radio -->
        
    </body>
</html>

